<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Sistema de Apoio à Gestão Municipal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Merriweather:wght@700&display=swap" rel="stylesheet" />
    <script>
        tailwind.config = { 
            theme: {
                extend: {
                    colors: {
                        'law-navy': '#0A1931',
                        'law-navy2': '#1F3F6D',
                        'law-gold': '#C8A356', // Exemplo de cor Gold
                    },
                },
            },
        };
    </script>
    <style>
        /* CSS para o ícone ativo (opcional) */
        .btn-app.active {
            background-color: #C8A356; /* law-gold */
            color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,.2);
        }
    </style>
</head>
<body class="min-h-screen bg-slate-100 flex p-0">

    <div id="sidebar" class="w-40 bg-law-navy flex-shrink-0 flex flex-col items-center py-8 space-y-6 shadow-lg h-screen sticky top-0">
        
        <button data-target-id="app-contratos" data-url="https://danilobrand-adv.github.io/contratos/" id="btn-sagm" class="btn-app w-36 h-8 bg-law-navy2 text-slate-400 rounded-xl hover:bg-law-gold/90 hover:text-white transition flex items-center justify-center">
             <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mr-1" viewBox="0 0 24 24" fill="currentColor"><path d="M10 4H4a2 2 0 00-2 2v12a2 2 0 002 2h16a2 2 0 002-2V8a2 2 0 00-2-2h-8l-2-2z"></path></svg>
             <span class="text-xs font-semibold">FISCAL DE CONTRATO</span>
        </button>

        <button data-target-id="app-leis" data-url="https://danilobrand-adv.github.io/legisla-omunicipal//" id="btn-leis" class="btn-app w-36 h-8 bg-law-navy2 text-slate-400 rounded-xl hover:bg-law-gold/90 hover:text-white transition flex items-center justify-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mr-1" viewBox="0 0 24 24" fill="currentColor"><path d="M5 21h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2zM7 7h10v2H7V7zm10 4H7v2h10v-2zm0 4H7v2h10v-2z"/></svg>
            <span class="text-xs font-semibold">ACERVO DE LEIS</span>
        </button>

        <button data-target-id="app-sagm-local" data-url="https://danilobrand-adv.github.io/FCON/" id="btn-outra-app" class="btn-app w-36 h-8 bg-law-navy2 text-slate-400 rounded-xl hover:bg-law-gold/90 hover:text-white transition flex items-center justify-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mr-1" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15l-4-4 1.41-1.41L11 14.17l4.59-4.59L17 11l-6 6z"></path></svg>
            <span class="text-xs font-semibold">FERRAMENTAS DE CONTROLE</span>
        </button>

    </div>

    <main class="flex-grow p-4">
        
        <div id="app-contratos" class="app-container w-full h-full hidden">
            <iframe data-url="https://danilobrand-adv.github.io/contratos/" class="w-full h-full border-2 border-slate-300 rounded-xl shadow-xl" frameborder="0"></iframe>
        </div>

        <div id="app-leis" class="app-container w-full h-full hidden">
            <iframe data-url="https://danilobrand-adv.github.io/legisla-omunicipal//" class="w-full h-full border-2 border-slate-300 rounded-xl shadow-xl" frameborder="0"></iframe>
        </div>

        <div id="app-sagm-local" class="app-container w-full h-full hidden">
            <iframe data-url="https://danilobrand-adv.github.io/FCON/" class="w-full h-full border-2 border-slate-300 rounded-xl shadow-xl" frameborder="0"></iframe>
        </div>
        
    </main>

    <script>
        const appContainers = document.querySelectorAll('.app-container');
        const buttons = document.querySelectorAll('.btn-app');
        const defaultAppId = 'app-contratos'; // Define a aplicação padrão (Contratos)

        function loadIframe(iframe) {
            const dataUrl = iframe.getAttribute('data-url');
            // Carrega o src apenas se o data-url existir e o src ainda não tiver sido definido
            if (dataUrl && !iframe.getAttribute('src')) {
                iframe.setAttribute('src', dataUrl);
            }
        }

        function navigateToApp(appId, button) {
            // 1. Oculta todos os contêineres de aplicação
            appContainers.forEach(container => {
                container.classList.add('hidden');
            });

            // 2. Mostra o contêiner alvo e carrega (se ainda não carregado)
            const targetContainer = document.getElementById(appId);
            if (targetContainer) {
                targetContainer.classList.remove('hidden');
                const iframe = targetContainer.querySelector('iframe');
                loadIframe(iframe); // Chama a função de carregamento/cache
            }

            // 3. Atualiza o estado visual do menu (ativo)
            buttons.forEach(btn => {
                btn.classList.remove('active', 'bg-law-gold', 'text-white');
                btn.classList.add('bg-law-navy2', 'text-slate-400');
            });
            button.classList.add('active', 'bg-law-gold', 'text-white');
            button.classList.remove('bg-law-navy2', 'text-slate-400');
        }

        // Adiciona o evento de clique a todos os botões da aplicação
        buttons.forEach(button => {
            button.addEventListener('click', () => {
                const appId = button.getAttribute('data-target-id');
                navigateToApp(appId, button);
            });
        });

        // -----------------------------------------------------------
        // LÓGICA DE INICIALIZAÇÃO E PRÉ-CARREGAMENTO
        // -----------------------------------------------------------
        document.addEventListener('DOMContentLoaded', () => {
             const defaultButton = document.getElementById('btn-sagm');
             
             // 1. Carrega a aplicação padrão (CONTRATOS) imediatamente
             if (defaultButton) {
                 navigateToApp(defaultAppId, defaultButton);
             }
             
             // 2. PRÉ-CARREGAMENTO das outras aplicações após um pequeno delay.
             // Isso permite que a aplicação padrão carregue primeiro, sem competir por recursos.
             window.onload = function() {
                 setTimeout(() => {
                     appContainers.forEach(container => {
                         const appId = container.id;
                         // Pré-carrega APENAS se não for a aplicação padrão (que já está carregando)
                         if (appId !== defaultAppId) {
                             const iframe = container.querySelector('iframe');
                             loadIframe(iframe);
                             console.log(`Pré-carregando: ${appId}`);
                         }
                     });
                 }, 500); // 500ms de delay para não atrasar o carregamento inicial da página.
             }
        });
    </script>
</body>
</html>
